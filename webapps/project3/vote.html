<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
   <head>
      <link rel="icon" href="image/favicon.ico" />
      <link rel="shortcut icon" href="image/favicon.ico" />
      <link rel="stylesheet" type="text/css" href="style/project3.css" />
      
      <script type="text/javascript" src="script/arguments.js"></script>
      <script type="text/javascript" src="script/connectivity.js"></script>
      <script type="text/javascript" src="script/external.js"></script>
      <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
      <script type="text/javascript">
			var projectID = getArgument("project");
			if(projectID == null)
			{
				window.location = "loggedin.html";
			}
			
			// check immedietly that the user is actually logged in
			$.getJSON("http://judah.cedarville.edu/rmoreha/IsLoggedIn?callback=?", function(data)
 		   {
				if(data.userID == null)
				{
					window.location = "index.html";
				}
				else if(data.isAdmin)
				{
					window.location = "loggedin.html";
				}
 		   });
			
			/*
			 * When the page has loaded, fill in the usernames list with all user's names and fill the table
			 * with user and project information.
			 */
			function fillComponents()
			{
				$.getJSON("http://judah.cedarville.edu/rmoreha/GetProject?callback=?", {"projectID": projectID}, function(project)
			   {
					// fill the project name
					$(".projectInfo").text(project.description);
				
					$.getJSON("http://judah.cedarville.edu/rmoreha/GetUser?callback=?", function(user)
				   {
						$.getJSON("http://judah.cedarville.edu/rmoreha/GetUserList?callback=?", function(users)
						{
							for(var i = 0; i < users.users.length; ++i)
							{
								var currUserID = users.users[i].userID;
								var currUserDisp = users.users[i].name;

								// Don't display the names of voter or anyone on their team if this is a partner project
								if(user.userID == currUserID)
									continue;
								if(project.isPartner && (user.firstPartner == currUserID || user.secondPartner == currUserID))
									continue;

								// All good, show to lists
								var option = "<option value=\"" + currUserID + "\">" + currUserDisp + "</option>";
								$("#firstPlaceSelect").append(option);
								$("#secondPlaceSelect").append(option);
								$("#thirdPlaceSelect").append(option);
								$("#firstWriteInUser").append(option);
								$("#secondWriteInUser").append(option);
								$("#thirdWriteInUser").append(option);
							}
						});
					});
			   });
				
				fillView();
			}
		</script>
      <title>Alex Laird | Web Applications (CS 4220) | Project 3 | Vote</title>
	</head>
   
   <body id="project3LoggedIn" onload="externals(); fillComponents();">
   	<div id="content">
         <div id="header">
            <h1><span>Welcome to the People's Choice Awards</span></h1>
         </div><span><span>
         
         <div id="leftColumn">
         	<h1><span>&nbsp;</span></h1>
            <div align="center">
            	<h2><span>Results for</span></h2><h4><span class="projectInfo">&nbsp;</span></h4>
            	<table id="viewTable">
               </table><br />
               <table id="writeInsTable">
               </table>
            </div>
            <h3><span>&nbsp;</span></h3>
         </div>
         
         <div id="rightColumn">
           	<h2><span>&nbsp;</span></h2>
	            <div align="center">
               	<h6><span>Vote</span></h6>
                  <p class="p1"><a href="loggedin.html">Back</a> to the People's Choice main.</p>
                  <b>Cast your vote for <span class="projectInfo">&nbsp;</span></b>
                  <form id="voteForm" onsubmit="goVote(); return false;">
                  	<table id="voteTable">
                     	<tr>
                        	<td><div align="right">First Place:</div></td>
                           <td><select id="firstPlaceSelect"><option value="">Select User:</option></select></td>
                        </tr>
                        <tr>
                        	<td><div align="right">Second Place:</div></td>
                           <td><select id="secondPlaceSelect"><option value="">Select User:</option></select></td>
                        </tr>
                        <tr>
                        	<td><div align="right">Third Place:</div></td>
                           <td><select id="thirdPlaceSelect"><option value="">Select User:</option></select></td>
                        </tr>
                        <tr><td>&nbsp;</td><td></td></tr>
                        
                        <tr>
                        	<td colspan="2"><div align="center"><b>Write-Ins</b></div></td>
                        </tr>
                        <tr>
                        	<td colspan="2"><div align="center"><select id="firstWriteInUser"><option value="">Select User:</option></select></div></td>
                        </tr>
                        <tr>
                        	<td colspan="2"><div align="center"><input id="firstWriteIn" name="firstWriteIn" type="text" /></div></td>
                        </tr>
                        <tr>
                        	<td colspan="2"><div align="center"><select id="secondWriteInUser"><option value="">Select User:</option></select></div></td>
                        </tr>
                        <tr>
                        	<td colspan="2"><div align="center"><input id="secondWriteIn" name="secondWriteIn" type="text" /></div></td>
                        </tr>
                        <tr>
                        	<td colspan="2"><div align="center"><select id="thirdWriteInUser"><option value="">Select User:</option></select></div></td>
                        </tr>
                        <tr>
                        	<td colspan="2"><div align="center"><input id="thirdWriteIn" name="thirdWriteIn" type="text" /></div></td>
                        </tr>
                        <tr>
                           <td id="vote_info">&nbsp;</td>
                        </tr>
                        <tr>
                        	<td><div align="right"><input type="reset" id="voteResetButton" value="Reset" /></div></td>
                           <td><div align="center"><input type="submit" id="voteSubmitButton" value="Go!" /></div></td>
                        </tr>
                     </table>
                  </form>
                  </div>
            <h4><span>&nbsp;</span></h4>
         </div>
         
         <div id="footer">
            <p class="p1"><span>Go <a id="back" href="../cs4220.html" title="Back to my project's main page!">back</a> to my project's main menu.</span></p>
            <p class="p2">Created in 2010 by <a href="http://www.alexlaird.net/" title="This is my real website, which you should check out" rel="external">Alex Laird</a> and <a href="http://traherom.com" rel="external">Ryan Morehart</a>. If you feel you have reached this page in error, panic is an appropriate reaction.</p>
         </div>
      </span></span></div>
   </body>
</html>
