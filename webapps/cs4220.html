<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.1//EN' 'http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en'>
<head>
	<title>Ryan Morehart Web App Projects</title>

	<link rel="stylesheet" type="text/css" href="home.css" />
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js" type="text/javascript"></script>
</head>
<body>

<div id="container">
	<div id="loading">
	<p>For reasons known to the rest of the world, the individual who created
	this page is totally pretentious and didn't want to have to edit the page
	ever to add new links to the project listing. Hence, this absurd call
	back to a PHP file behind the scenes that feeds this page JSON data.</p>

	<p>The call actually takes like zero time, but a wait was needed anyway.
	Not due to some technical limitation, oh no. I simply have the wait
	to give that the nice "this page is so cool and big that it takes a
	bit" feel, which is obviously total nonsense.</p>

	<p>You have to wait <span id="loadtime">-</span> more seconds before you can
	view the page. The load is actually happening right now, a message will
	appear below here telling you just how much extra you're suffering
	for no reason soon.</p>
	</div>

	<div id="content"></div>
	<div class="clear"></div>

	<div id="description"></div>
</div>

<script type="text/javascript">
//<![CDATA[
var waitLeft = 5;
var pageData = null;

var interval = null;
function loadWait()
{
	waitLeft--;
	$("#loadtime").text(waitLeft);

	if(waitLeft == 0)
	{
		clearInterval(interval);

		// Display. We assume that the page has finished loading
		$("#loading").fadeOut(1000);
		$("#content").fadeIn(1000);
	}
}

function loadPage()
{
	$.getJSON("projects.php?jsoncallback=?", function(data) {
		// Name and course
		var name = document.createElement("span");
		$(name).attr("id", "name")
			   .text(data.name);
	
		var course = document.createElement("span");
		$(course).attr("id", "course")
				 .text(data.course);

		// Process each project
		var projects = document.createElement("div");
		$(projects).attr("id", "projects");
		$.each(data.projects, function(i, item){
			var a = document.createElement("a");
			$(a).attr('href', item.url)
				.text(item.title)
				.data('description', item.description);
			$(projects).append(a);
			});

		// Place everything in DOM
		$("#content").append(name)
					 .append(course)
					 .append(projects)

		// Ready to display the descriptions
		$("#projects a").hover(
			function(){
				// Show description
				$("#description").html($(this).data('description'));
				$("#description").stop(true, true).slideDown();
			},
			function(){
				// Hide desciption
				$("#description").slideUp();
			});

		// And taunt
		$("<p />").text("The page is loaded and all nicely in the DOM now. "
						+ "Too bad you have to wait anyway, wasting " + waitLeft
						+ " seconds of your life.")
				  .appendTo("#loading");
		});
}

$(document).ready(function() {
	// Start loading page in background so there's actually no delay when the "wait" is up
	loadPage();

	// Only make them wait if they haven't been here before
	if(!document.cookie)
	{
		document.cookie = "front=visited";

		// Initialize load time so the user knows
		interval = setInterval("loadWait()", 1000);
		$("#loadtime").text(waitLeft);
		loadWait();
	}
	else
	{
		$("#loading").fadeOut(1000);
		$("#content").fadeIn(1000);
	}
	});
//]]>
</script>

</body>
</html>
